<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Sauna Writeup" />
<meta property="og:locale" content="en" />
<meta name="description" content="❗Important Commands in this article ❗" />
<meta property="og:description" content="❗Important Commands in this article ❗" />
<link rel="canonical" href="http://localhost:4000/posts/Sauna-HTB-Machine/" />
<meta property="og:url" content="http://localhost:4000/posts/Sauna-HTB-Machine/" />
<meta property="og:site_name" content="Yazan’s blog" />
<meta property="og:image" content="http://localhost:4000/photos/Sauna/bg.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-28T11:00:00-04:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/photos/Sauna/bg.jpg" />
<meta property="twitter:title" content="Sauna Writeup" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-09-28T11:00:00-04:00","datePublished":"2025-09-28T11:00:00-04:00","description":"❗Important Commands in this article ❗","headline":"Sauna Writeup","image":"http://localhost:4000/photos/Sauna/bg.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Sauna-HTB-Machine/"},"url":"http://localhost:4000/posts/Sauna-HTB-Machine/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Sauna Writeup | Yazan's blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Yazan's blog">
<meta name="application-name" content="Yazan's blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="https://pbs.twimg.com/profile_images/1972370839052984321/zQITOLAW_400x400.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Yazan's blog</a>
    <p class="site-subtitle fst-italic mb-0">Blue Teaming, Windows Exploitation and Forensics, Training & Labs</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/training/" class="nav-link">
            <i class="fa-fw fa-solid fa-school"></i>
            

            <span>TRAINING</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/lilravx"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/yazen-salehh/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['0xg3n0','proton.me'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Sauna Writeup</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="false">
  <header>
    <h1 data-toc-skip>Sauna Writeup</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1759071600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Sep 28, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/photos/Sauna/bg.jpg" class="popup img-link preview-img shimmer"><img src="/photos/Sauna/bg.jpg"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://www.linkedin.com/in/yazen-salehh/">Yazan Saleh</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="743 words"
>
  <em>4 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  

  <div class="content">
    <p>❗Important Commands in this article ❗</p>

<div class="language-jsx highlighter-rouge"><div class="code-header">
        <span data-label-text="Jsx"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="p">.</span> <span class="nx">GetNPUsers</span><span class="p">.</span><span class="nx">py</span> <span class="nx">EGOTISTICAL</span><span class="o">-</span><span class="nx">BANK</span><span class="p">.</span><span class="nx">LOCAL</span><span class="o">/</span> <span class="o">-</span><span class="nx">usersfile</span> <span class="nx">users_ready</span> <span class="o">-</span><span class="nx">dc</span><span class="o">-</span><span class="nx">ip</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.175</span> <span class="o">-</span><span class="nx">no</span><span class="o">-</span><span class="nx">pass</span>
<span class="mi">2</span><span class="p">.</span> <span class="nx">upload</span> <span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">pref</span><span class="o">/</span><span class="nx">winPEAS</span><span class="p">.</span><span class="nx">ps1</span> <span class="nx">C</span><span class="p">:</span><span class="err">\\</span><span class="nx">Users</span><span class="err">\\</span><span class="nx">FSmith</span><span class="err">\\</span><span class="nx">Documents</span><span class="err">\\</span><span class="nx">winPEAS</span><span class="p">.</span><span class="nx">ps1</span>
<span class="mi">3</span><span class="p">.</span> <span class="nx">Get</span><span class="o">-</span><span class="nx">ObjectAcl</span> <span class="o">|</span> <span class="nx">Select</span> <span class="nx">ObjectSID</span><span class="p">,</span><span class="nx">ActiveDirectoryRights</span> <span class="o">|</span> <span class="nx">Format</span><span class="o">-</span><span class="nx">List</span>
<span class="mi">4</span><span class="p">.</span> <span class="nx">secretsdump</span><span class="p">.</span><span class="nx">py</span> <span class="nx">svc_loanmgr</span><span class="p">:</span><span class="nx">Moneymakestheworldgoround</span><span class="o">!</span><span class="p">@</span><span class="nd">10</span><span class="p">.</span><span class="mf">10.10</span><span class="p">.</span><span class="mi">175</span>
<span class="mi">5</span><span class="p">.</span> <span class="p">[</span><span class="nx">secretsdump</span><span class="p">.</span><span class="nx">py</span><span class="p">](</span><span class="nx">http</span><span class="p">:</span><span class="c1">//secretsdump.py/) svc_loanmgr:Moneymakestheworldgoround!@10.10.10.175</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Sauna is an easy difficulty Windows machine that features Active Directory enumeration and exploitation, these two attacks we can take a benefit from them when we do a Security assessment to the companies and entities, you will find some of users have wrong permission that leads to these attacks.</p>

<p>with this article am going to correlate everything with realistic scenarios that i personally faced in my technical assessment tasks at my work.</p>

<p>after the initial enumeration of the machine , I found it is a DC and many of interesting ports that opened to the public such as port 88</p>

<p>for this port (88) -  this is responsible for Kerberos authentication,</p>

<p>while this port is responsible for Kerberos authentication its a good point to exploit it by finding if there is a user have permission “<strong>Do not require Kerberos pre-authentication”.</strong></p>

<p><strong>why we are looking for this permission ?</strong></p>

<p>because in the first step of the authentication with Kerberos the user sends a message requests     AS-REQ asking for verifying username and password from the KDC in the domain controller in order to granting a ticket, the DC will check the user and  password and then it will send AS-RES, if the permission “<strong>Do not require Kerberos pre-authentication”</strong>  enabled on the user that requested the ticket, <em>**</em>That means the KDC will send the AS-REP (TGT) directly to the user without verifying the password first. This AS-REP contains both the user’s NTLM hash and the TGT encrypted by the KRBTGT account.</p>

<p>In this attack, we focus on extracting the NTLM hash part to crack the user’s password.</p>

<p><a href="/photos/Sauna/second.png" class="popup img-link shimmer"><img src="/photos/Sauna/second.png" alt="" loading="lazy"></a></p>

<p><a href="/photos/Sauna/third.png" class="popup img-link shimmer"><img src="/photos/Sauna/third.png" alt="" loading="lazy"></a></p>

<p>Then i need the users list for Active directory, the good point in the Active directroy that All administrator have the same concept about creating users in the active directory, the conecpt is, don’t add the full username to login the user name have to be first letter of his username and then family name, or user name and first or and second  letter of the family name.</p>

<p>for example</p>

<p>my name is yazan saleh  it can be Y.saleh or Yazan.sh</p>

<p>we can use tool such as username-anarchy  to create our own list, for the Sauna’s machine i got all the usernames from web page they posted the team member, so  generate a list for each name</p>

<p><a href="/photos/Sauna/fourth.png" class="popup img-link shimmer"><img src="/photos/Sauna/fourth.png" alt="" loading="lazy"></a></p>

<p>now we need to start our hypothisi for the vulnarability on kerberos port, we have our list ready, and we have ip of the machine</p>

<p>we can use <a href="http://NPGetusers.py">NPGetusers.py</a> from impact scripts, if you didn’t find it online you can install impacet using pip</p>

<div class="language-jsx highlighter-rouge"><div class="code-header">
        <span data-label-text="Jsx"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nx">GetNPUsers</span><span class="p">.</span><span class="nx">py</span> <span class="nx">EGOTISTICAL</span><span class="o">-</span><span class="nx">BANK</span><span class="p">.</span><span class="nx">LOCAL</span><span class="o">/</span> <span class="o">-</span><span class="nx">usersfile</span> <span class="nx">users_ready</span> <span class="o">-</span><span class="nx">dc</span><span class="o">-</span><span class="nx">ip</span> <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.175</span> <span class="o">-</span><span class="nx">no</span><span class="o">-</span><span class="nx">pass</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/photos/Sauna/fifth.png" class="popup img-link shimmer"><img src="/photos/Sauna/fifth.png" alt="" loading="lazy"></a></p>

<p>cracking the user by finding the module on hashcat table that start with $krb4asrep$23$</p>

<p><a href="/photos/Sauna/sexith.png" class="popup img-link shimmer"><img src="/photos/Sauna/sexith.png" alt="" loading="lazy"></a></p>

<p>now we can connect on the machine using evil-winrm port 5985</p>

<p>by using evil-winrm plugins we can upload our winpeas to Check the <strong>Local Windows Privilege Escalation</strong></p>

<p><a href="/photos/Sauna/sevnth.png" class="popup img-link shimmer"><img src="/photos/Sauna/sevnth.png" alt="" loading="lazy"></a></p>

<p>to upload files using evil-winrm you have to head to the directory that contains the files you need to uplaod to the victem machine, then lunch your connection from their as shows in the figure below:</p>

<p><a href="/photos/Sauna/egiht.png" class="popup img-link shimmer"><img src="/photos/Sauna/egiht.png" alt="" loading="lazy"></a></p>

<p>then use upload plugin to upload it their.</p>

<div class="language-jsx highlighter-rouge"><div class="code-header">
        <span data-label-text="Jsx"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nx">upload</span> <span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">pref</span><span class="o">/</span><span class="nx">winPEAS</span><span class="p">.</span><span class="nx">ps1</span> <span class="nx">C</span><span class="p">:</span><span class="err">\\</span><span class="nx">Users</span><span class="err">\\</span><span class="nx">FSmith</span><span class="err">\\</span><span class="nx">Documents</span><span class="err">\\</span><span class="nx">winPEAS</span><span class="p">.</span><span class="nx">ps1</span>
</pre></td></tr></tbody></table></code></div></div>

<p>After running the script i found the svc_loanmanager services with password that added on auto login, and this services is part of admin group.</p>

<p><a href="/photos/Sauna/nine.png" class="popup img-link shimmer"><img src="/photos/Sauna/nine.png" alt="" loading="lazy"></a></p>

<p>then i enumerated the ACL for the following users  using power view and AD module</p>

<p><a href="/photos/Sauna/ten.png" class="popup img-link shimmer"><img src="/photos/Sauna/ten.png" alt="" loading="lazy"></a></p>

<p>by command</p>

<div class="language-jsx highlighter-rouge"><div class="code-header">
        <span data-label-text="Jsx"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nx">Get</span><span class="o">-</span><span class="nx">ObjectAcl</span> <span class="o">|</span> <span class="nx">Select</span> <span class="nx">ObjectSID</span><span class="p">,</span><span class="nx">ActiveDirectoryRights</span> <span class="o">|</span> <span class="nx">Format</span><span class="o">-</span><span class="nx">List</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/photos/Sauna/eleven.png" class="popup img-link shimmer"><img src="/photos/Sauna/eleven.png" alt="" loading="lazy"></a></p>

<p><strong>DCsync</strong> abuses Active Directory replication: an attacker impersonates a domain controller and requests replication from a real DC to obtain credential material (password hashes, Kerberos keys, etc.). This lets the attacker harvest account credentials without directly compromising the domain controller’s NTDS.dit file.</p>

<p><strong>How it works (short):</strong></p>

<p><a href="/photos/Sauna/twleve.png" class="popup img-link shimmer"><img src="/photos/Sauna/twleve.png" alt="" loading="lazy"></a></p>

<ul>
  <li>AD replication allows DCs to exchange directory changes.</li>
  <li>If an account has the appropriate replication privileges, an actor can request those changes and receive sensitive secrets (NT hashes, AES keys) for domain accounts.</li>
  <li>This is not possible for arbitrary domain users — specific permissions are required.</li>
</ul>

<p><strong>Required permissions / privileges</strong></p>

<p>(typically granted to high-privilege groups such as Domain Admins / Enterprise Admins / Domain Controllers, or explicitly delegated):</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">DS-Replication-Get-Changes</code></li>
  <li><code class="language-plaintext highlighter-rouge">DS-Replication-Get-Changes-All</code></li>
  <li><code class="language-plaintext highlighter-rouge">DS-Replication-Get-Changes-In-Filtered-Set</code></li>
</ul>

<p><a href="/photos/Sauna/thirteen.png" class="popup img-link shimmer"><img src="/photos/Sauna/thirteen.png" alt="" loading="lazy"></a></p>

<p>and found  permission <code class="language-plaintext highlighter-rouge">DS-Replication-Get-Changes</code> on the user SVC_Loanmgt</p>

<p>we can lunch our attack to get a copy of the ntds.dit file</p>

<p><a href="/photos/Sauna/forteen.png" class="popup img-link shimmer"><img src="/photos/Sauna/forteen.png" alt="" loading="lazy"></a></p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/active-directory-crtp/">Active Directory - CRTP</a>,
          <a href="/categories/dcsync/">DCsync</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/replication/"
            class="post-tag no-text-decoration"
          >Replication</a>
        
          <a
            href="/tags/dcsync/"
            class="post-tag no-text-decoration"
          >DCsync</a>
        
          <a
            href="/tags/as-rep-roasting/"
            class="post-tag no-text-decoration"
          >AS-REP Roasting</a>
        
          <a
            href="/tags/ad/"
            class="post-tag no-text-decoration"
          >AD</a>
        
          <a
            href="/tags/winrm/"
            class="post-tag no-text-decoration"
          >WinRM</a>
        
          <a
            href="/tags/winpeas/"
            class="post-tag no-text-decoration"
          >WinPEAS</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Sauna%20Writeup%20-%20Yazan's%20blog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSauna-HTB-Machine%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Sauna%20Writeup%20-%20Yazan's%20blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSauna-HTB-Machine%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSauna-HTB-Machine%2F&text=Sauna%20Writeup%20-%20Yazan's%20blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/VolatilityImageInfo/">Volatiltiy - imageinfo Plugin</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/DCsyncAttack/">DCsync Attack</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Replication/">What is Replication</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Sauna-HTB-Machine/">Sauna Writeup</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/replication/">Replication</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ad/">AD</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/as-rep-roasting/">AS-REP Roasting</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/changeall/">ChangeAll</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dcsync/">DCsync</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dfir/">DFIR</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/imageinfo/">imageinfo</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/kcc/">KCC</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ntds/">ntds</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/secretdump/">secretdump</a>
      
    </div>
  </section>


            </div>

            
              
              







            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Replication/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1759071600"
  data-df="ll"
  
>
  Sep 28, 2025
</time>

              <h4 class="pt-0 my-2">What is Replication</h4>
              <div class="text-muted">
                <p>DCsync  we need to understand Replication in order to perform DCsync Attack.  What is Replication in Active Directory?  Replication is the process used between Domain Controllers (DCs) in an Active...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/DCsyncAttack/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1759158000"
  data-df="ll"
  
>
  Sep 29, 2025
</time>

              <h4 class="pt-0 my-2">DCsync Attack</h4>
              <div class="text-muted">
                <p>**DCsync**  abuses Active Directory replication: an attacker impersonates a domain controller and requests replication from a real DC to obtain credential material (password hashes, Kerberos keys, ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Replication/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>What is Replication</p>
    </a>
  

  
    <a
      href="/posts/DCsyncAttack/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>DCsync Attack</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://www.linkedin.com/in/yazen-salehh/">Yazan Saleh</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/replication/">Replication</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ad/">AD</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/as-rep-roasting/">AS-REP Roasting</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/changeall/">ChangeAll</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dcsync/">DCsync</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dfir/">DFIR</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/imageinfo/">imageinfo</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/kcc/">KCC</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ntds/">ntds</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/secretdump/">secretdump</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

